@page "/"

@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@using SocialPlatformBlazor.Shared.ViewModels.Posts
@using SocialPlatformBlazor.Shared.ViewModels.Users

@inject PostsService postsService

<div>
    <PageTitle>SPB - Newsfeed</PageTitle>

    <h1>Hello, world!</h1>

    Welcome to your new app.

    <SurveyPrompt Title="How is Blazor working for you?" />
    @if (Posts != null)
    {
        @foreach (var post in Posts)
        {
            <PostInFeed Post="post" />
        }
    }

</div>
@code {
    private IEnumerable<PostInFeedViewModel>? Posts { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Posts = await postsService.LoadPostsAsync();
    }
}